<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>TRMNL Settings</title>

        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400..800;1,400..800&family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap"
            rel="stylesheet"
        />
        <style>
            body {
                width: 350px;
                padding: 20px;
                font-family: Inter, sans-serif;
                margin: 0;
                background-color: #f8f9fa;
                color: #333;
            }

            h2 {
                margin-top: 0;
                margin-bottom: 20px;
                color: #2c3e50;
                font-size: 20px;
            }

            .form-group {
                margin-bottom: 20px;
            }

            label {
                display: block;
                margin-bottom: 8px;
                font-weight: 600;
                color: #555;
                font-size: 14px;
            }

            input,
            select {
                width: 100%;
                padding: 10px;
                border: 1px solid #ddd;
                border-radius: 6px;
                font-size: 14px;
                background-color: #fff;
                color: #333;
                box-sizing: border-box;
            }

            input:focus,
            select:focus {
                outline: none;
                border-color: #007bff;
                box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.25);
            }

            button {
                background-color: #007bff;
                color: white;
                border: none;
                padding: 10px 16px;
                border-radius: 6px;
                cursor: pointer;
                font-size: 14px;
                font-weight: 500;
                transition: background-color 0.2s;
            }

            button:hover {
                background-color: #0056b3;
            }

            button:disabled {
                background-color: #6c757d;
                cursor: not-allowed;
            }

            .button-group {
                display: flex;
                gap: 10px;
                margin-top: 20px;
            }

            .button-group button {
                flex: 1;
            }

            .button-group button:only-child {
                max-width: 200px;
                margin: 0 auto;
            }

            #status {
                margin-top: 15px;
                padding: 10px;
                border-radius: 4px;
                font-size: 14px;
                text-align: center;
                min-height: 20px;
                font-weight: 600;
            }

            .status-success {
                color: #155724 !important;
                background-color: #d4edda !important;
                border: 1px solid #c3e6cb !important;
            }

            .status-error {
                color: #721c24 !important;
                background-color: #f8d7da !important;
                border: 1px solid #f5c6cb !important;
            }

            .status-info {
                font-size: 12px;
                color: #666;
                margin-top: 15px;
                line-height: 1.4;
            }

            .logout-section {
                border-top: 1px solid #dee2e6;
                padding-top: 20px;
                margin-top: 25px;
            }

            .logout-btn {
                background-color: #dc3545 !important;
                color: white !important;
                width: 100%;
            }

            .logout-btn:hover {
                background-color: #c82333 !important;
            }

            .logout-warning {
                font-size: 12px;
                color: #6c757d;
                margin-bottom: 10px;
                text-align: center;
            }

            .login-prompt {
                text-align: center;
                padding: 20px;
                background-color: #f8f9fa;
                border-radius: 8px;
                margin-bottom: 15px;
            }

            .login-prompt p {
                margin-bottom: 15px;
                color: #6c757d;
                font-size: 14px;
            }

            .login-btn {
                background-color: #28a745 !important;
                color: white !important;
                width: 100%;
                font-weight: 600;
            }

            .login-btn:hover {
                background-color: #218838 !important;
            }

            .advanced-section {
                margin-top: 20px;
                border: 1px solid #dee2e6;
                border-radius: 6px;
                padding: 0;
                background-color: #f8f9fa;
            }

            .advanced-section summary {
                cursor: pointer;
                font-weight: 600;
                color: #555;
                margin: 0;
                padding: 15px;
                outline: none;
                border-radius: 6px 6px 0 0;
                user-select: none;
            }

            .advanced-section summary:hover {
                color: #007bff;
                background-color: #e9ecef;
            }

            .advanced-section[open] summary {
                border-bottom: 1px solid #dee2e6;
                border-radius: 6px 6px 0 0;
            }

            .advanced-section > div {
                padding: 15px;
            }

            .advanced-section .button-group {
                margin: 15px 0;
                display: flex;
                gap: 10px;
                justify-content: center;
            }

            .advanced-section .button-group button {
                flex: 1;
                max-width: 150px;
            }

            .advanced-section .button-group button:only-child {
                max-width: 200px;
            }

            .advanced-section .toggle-manual-btn {
                margin-bottom: 15px;
                width: 100%;
                max-width: 250px;
            }

            .manual-api-section {
                margin-bottom: 15px;
            }

            .toggle-manual-btn {
                background-color: #6c757d !important;
                color: white !important;
                font-size: 13px;
                padding: 10px 20px;
                margin-top: 8px;
                border-radius: 6px;
                font-weight: 500;
                border: none;
                cursor: pointer;
                transition: background-color 0.2s;
            }

            .toggle-manual-btn:hover {
                background-color: #545b62 !important;
            }

            .hidden {
                display: none !important;
            }

            @media (prefers-color-scheme: dark) {
                body {
                    background-color: #1a1a1a;
                    color: #e9ecef;
                }

                h2 {
                    color: #f8f9fa;
                }

                label {
                    color: #ced4da;
                }

                input,
                select {
                    background-color: #333;
                    color: #fff;
                    border-color: #555;
                }

                input:focus,
                select:focus {
                    border-color: #0d6efd;
                }

                select option {
                    background-color: #333;
                    color: #fff;
                }

                .login-prompt {
                    background-color: #2d3748;
                }

                .login-prompt p {
                    color: #a0aec0;
                }

                .status-info {
                    color: #adb5bd;
                }

                .advanced-section {
                    background-color: #2d3748;
                    border-color: #333;
                }

                .advanced-section summary {
                    color: #ced4da;
                }

                .advanced-section summary:hover {
                    color: #0d6efd;
                    background-color: #3a4a5c;
                }

                .advanced-section[open] summary {
                    border-bottom-color: #333;
                }

                .logout-section {
                    border-top-color: #333;
                }

                .logout-warning {
                    color: #adb5bd;
                }

                .status-success {
                    color: #d1e7dd !important;
                    background-color: #0f2419 !important;
                    border: 1px solid #1c4532 !important;
                }

                .status-error {
                    color: #f8d7da !important;
                    background-color: #2c0b0e !important;
                    border: 1px solid #58151c !important;
                }
            }
        </style>
    </head>
    <body class="popup-body">
        <div>
            <h2 class="popup-title">TRMNL New Tab Settings</h2>

            <div id="device-selector-group" class="form-group hidden">
                <label for="device-select" class="popup-label"
                    >Select Device</label
                >
                <select id="device-select" class="popup-select">
                    <option value="">Loading devices...</option>
                </select>
            </div>

            <div class="form-group" id="login-section">
                <div id="login-prompt" class="login-prompt">
                    <p>
                        Please log in to your TRMNL account to access your
                        devices.
                    </p>
                    <button id="login-btn" class="login-btn">
                        Login to TRMNL
                    </button>
                </div>

            </div>

            <div id="status"></div>

            <details id="advanced-section" class="advanced-section">
                <summary>Advanced Settings</summary>
                
                <div style="text-align: center; margin-bottom: 15px;">
                    <button id="toggle-manual" class="toggle-manual-btn">
                        Use Manual API Key
                    </button>
                </div>
                
                <div id="manual-api-section" class="manual-api-section hidden">
                    <label for="api-key">Manual API Key</label>
                    <input
                        type="password"
                        id="api-key"
                        placeholder="Enter your API key manually"
                    />
                </div>

                <div class="button-group" style="margin-bottom: 15px;">
                    <button id="save-settings" style="display: none;">Save Settings</button>
                    <button id="refresh-now" style="display: none;">Refresh Now</button>
                </div>

                <div class="status-info">
                    <div id="last-updated"></div>
                    <div id="next-update"></div>
                    <div id="refresh-rate"></div>
                </div>
            </details>

            <div id="logout-section" class="logout-section hidden">
                <div class="logout-warning">
                    This will clear all extension data and log you out.
                </div>
                <button id="logout-btn" class="logout-btn">
                    Logout & Reset
                </button>
            </div>
        </div>

        <script src="popup.js"></script>
    </body>
</html>
